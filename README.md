# Track Order Management System (TOMS)
[Trunk Based Development](https://trunkbaseddevelopment.com/) |
[Standard version](https://github.com/conventional-changelog/standard-version) |
[Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0-beta.2/)

[CHANGELOG](CHANGELOG.md) (История изменений проекта)

## Содержание
1. [Ценность](#ценность)
2. [Техническое задание](#техническое-задание)
3. [Установка](#установка)
4. [Тесты](#тесты)
5. [Статический анализ](#статический-анализ)
6. [Документация по API](#документация-по-API)

## Ценность
Необходимо написать паттерн цепочку обязанностей для проверки запроса от клиента.
- проверить статус пользователя
- проверить роль пользователя
- проверить наличие разрешения у пользователя
- проверить чрезмерную активность пользователя для текущей роли и разрешения

Статусы, роли и разрешения на свое усмотрение, лимиты по активности произвольные, прерывать запрос, если не прошла хотя бы одна проверка
## Техническое задание
Реализовать систему отслеживания информации по заказам.

Роли пользователей: Гость, Клиент, Оператор, Поставщик, Администратор

Клиент:
может запросить информацию по заказу включая историю статусов и комментариев

Оператор: может взять новый заказ в работу, собрать заказ, подготовить к отгрузке, отправить на склад, принять на складе, доставить клиенту и сделать возврат. Каждое действие он может совершать последовательно в зависимости от статуса заказа

Поставщик: может создать новые заказы

Администратор: может выполнять все действия и менять статусы без учета последовательности. Также администратор может настраивать лимиты по количеству запросов для всех ролей

## Установка
```bash
$ git clone git@github.com:z-ev/tms.git && cd tms 
$ cp .env.example .env
$ echo "127.0.0.1 tms.loc www.tms.loc" | sudo tee -a /etc/hosts
$ make up
$ xdg-open http://tms.loc:8089
```

## Тесты
```bash
$ make tc
$ xdg-open http://tms.loc/coverage/index.html
```
### Coverage репорт
http://tms.loc/coverage/index.html

## Статический анализ
```bash
$ make stat
```
или по отдельности:
```bash
$ make phpstan
$ make psalm
```

# Документация по API
## Swagger
http://tms.loc/api/documentation

## Postman
[Скачать коллекцию для импорта](./docs/TOMS.postman_collection.json)
